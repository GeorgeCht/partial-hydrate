{"version":3,"file":"index.umd.js","sources":["../src/PartialHydrate.tsx"],"sourcesContent":["import * as React from 'react'\n\n/**\n * Requires at least one property of the given type T.\n *\n * @template T - The type to require properties from.\n * @template Keys - The keys of the type T to enforce presence.\n */\nexport type RequireAtLeastOne<T, Keys extends keyof T = keyof T> = Pick<T, Exclude<keyof T, Keys>> &\n  {\n    [K in Keys]-?: Required<Pick<T, K>> & Partial<Pick<T, Exclude<Keys, K>>>\n  }[Keys]\n\n/**\n * Function type for checking if a value is defined.\n *\n * @template T - The type of the value to check.\n * @param {T | undefined} v - The value to check for definedness.\n * @returns {boolean} - True if the value is defined, false otherwise.\n */\nexport interface FnIsDefined {\n  <T>(v: T | undefined): boolean\n}\n\n/**\n * Type for partial hydration props in React components.\n */\nexport type PartialHydrateProps = {\n  minWidth?: number\n  maxWidth?: number\n  when?: () => boolean\n  children: React.ReactNode\n}\n\nfunction useIsFirstRender(): boolean {\n  const isFirst = React.useRef(true)\n  return !!isFirst.current && ((isFirst.current = false), true)\n}\n\nconst isDefined: FnIsDefined = (v) => typeof v !== 'undefined' && v !== null\n\nexport const PartialHydrate: React.FC<\n  RequireAtLeastOne<PartialHydrateProps, 'minWidth' | 'maxWidth' | 'when'>\n> = ({ children, minWidth, maxWidth, when }) => {\n  const id = 'partial:' + React.useId()\n  const isClient = isDefined(window)\n  const isFirstRender = useIsFirstRender()\n  const innerWidth = window.innerWidth\n\n  const removeChildren = (id: string) => {\n    if (isClient && isFirstRender) {\n      const el = document.getElementById(id)\n      el && (el.innerHTML = '')\n    }\n    return !0\n  }\n\n  const render = isDefined(when)\n    ? (isClient ? when!() : true) && removeChildren(id)\n    : isDefined(minWidth) && isDefined(maxWidth)\n      ? (isClient ? innerWidth <= minWidth! && innerWidth >= maxWidth! : true) && removeChildren(id)\n      : isDefined(minWidth)\n        ? (isClient ? innerWidth <= minWidth! : true) && removeChildren(id)\n        : (isClient ? innerWidth >= maxWidth! : true) && removeChildren(id)\n\n  return (\n    <div id={id} style={{ display: render ? 'contents' : 'none' }}>\n      {render && children}\n    </div>\n  )\n}\n"],"names":["isDefined","v","_ref","isFirst","children","minWidth","maxWidth","when","id","React","useId","isClient","window","isFirstRender","useRef","current","innerWidth","removeChildren","el","document","getElementById","innerHTML","render","_jsx","style","display"],"mappings":"inBAuCMA,EAAyB,SAACC,GAAM,OAAA,MAAOA,CAA+B,mBAIxE,SAFuBC,GAEoB,IARvCC,EAQDC,EAAQF,EAARE,SAAUC,EAAQH,EAARG,SAAUC,EAAQJ,EAARI,SAAUC,EAAIL,EAAJK,KAC7BC,EAAK,WAAaC,EAAMC,QACxBC,EAAWX,EAAUY,QACrBC,KAXAV,EAAUM,EAAMK,QAAO,IACZC,UAAaZ,EAAQY,SAAU,GAAQ,GAWlDC,EAAaJ,OAAOI,WAEpBC,EAAiB,SAACT,GACtB,GAAIG,GAAYE,EAAe,CAC7B,IAAMK,EAAKC,SAASC,eAAeZ,GACnCU,IAAOA,EAAGG,UAAY,GACxB,CACA,OAAO,CACT,EAEMC,EAAStB,EAAUO,KACpBI,GAAWJ,MAAmBU,EAAeT,GAC9CR,EAAUK,IAAaL,EAAUM,KAC9BK,GAAWK,GAAcX,GAAaW,GAAcV,IAAqBW,EAAeT,GACzFR,EAAUK,KACPM,GAAWK,GAAcX,IAAqBY,EAAeT,KAC7DG,GAAWK,GAAcV,IAAqBW,EAAeT,GAEtE,OACEe,EAAAA,IAAK,MAAA,CAAAf,GAAIA,EAAIgB,MAAO,CAAEC,QAASH,EAAS,WAAa,QAClDlB,SAAAkB,GAAUlB,GAGjB"}